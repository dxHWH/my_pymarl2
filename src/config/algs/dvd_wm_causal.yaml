
run: "dual_run"

# --- DVD-WM Causal Config ---
name: "dvd_wm_causal"

# 1. 核心组件
learner: "dvd_wm_causal_learner"
mixer: "dvd_wm_causal"

# [Controller 参数]
agent_output_type: "q"

# [Mixer 参数]
mixing_embed_dim: 32
hypernet_hidden_dim: 64
hypernet_layers: 2
double_q: True

# [优化器参数]
optimizer: "adam"

# [RL 关键参数 - 关键修复]
td_lambda: 0.6            # 缺失的 TD-Lambda 参数，用于计算多步回报

# 2. World Model (标准 RNN-VAE)
world_model_type: "vae_rnn"
wm_batch_size: 128
wm_hidden_dim: 128        # World Model RNN 隐层维度
wm_latent_dim: 64         # Latent Z 维度
wm_lr: 0.0005             # World Model 学习率
wm_kl_beta: 0.1
wm_loss_weight: 0.1

# 3. 因果对齐配置
causal_beta: 0.01
align_start_steps: 500000 # Warmup

# 4. 采样与其他
dvd_samples: 8
use_z_bias: True
use_z_warmup: False
z_warmup_steps: 100000

# Standard Configs
action_selector: "epsilon_greedy"
epsilon_start: 1.0
epsilon_finish: 0.05
epsilon_anneal_time: 100000
runner: "episode"
batch_size: 64
buffer_size: 5000
t_max: 10500000
learner_log_interval: 2000
test_interval: 2000
test_nepisode: 32
test_greedy: True
log_interval: 2000

target_update_interval: 200
obs_agent_id: True
obs_last_action: True